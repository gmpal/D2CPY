

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>D2C Class &#8212; D2CPY</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'D2C_implementation';</script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Utilities Functions" href="utils.html" />
    <link rel="prev" title="Examples" href="D2C_examples.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="README.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="README.html">
                    Welcome to D2CPY!
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithm.html">The D2C Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="main.html">Usage</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="simulatedDAGs_introduction.html">Simulated DAGs</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="simulatedDAGs_examples.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulatedDAGs_implementation.html">Implementation</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="D2C_introduction.html">D2C</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="D2C_examples.html">Examples</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Implementation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Additional functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/gmpal/D2CPY" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/gmpal/D2CPY/issues/new?title=Issue%20on%20page%20%2FD2C_implementation.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/D2C_implementation.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>D2C Class</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#class-attributes">Class Attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#class-structure">Class Structure</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="d2c-class">
<h1>D2C Class<a class="headerlink" href="#d2c-class" title="Permalink to this heading">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">D2C</span></code> class is responsible for Dependency to Causality (D2C) analysis. D2C is a method for inferring causal relationships from observational data using simulated directed acyclic graphs (DAGs). The D2C class uses these DAGs to compute asymmetric descriptors from the observations associated with each DAG. This class allows for a comprehensive analysis, offering functions for initialization, computation of descriptors, and model evaluation.</p>
<section id="class-attributes">
<h2>Class Attributes<a class="headerlink" href="#class-attributes" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DAGs_index</span></code>: A numpy array containing the indices of the simulated directed acyclic graphs (DAGs).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DAGs</span></code>: The list of simulated DAGs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">observations_from_DAGs</span></code>: The list of observations associated with each simulated DAG.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rev</span></code>: A boolean flag indicating whether to consider reverse edges. By default, it’s set to True, indicating that reverse edges should be considered.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X</span></code>: A DataFrame containing the computed descriptors from the observations. Initially, it’s set to None and gets populated by the <code class="docutils literal notranslate"><span class="pre">initialize</span></code> method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Y</span></code>: A DataFrame containing the labels indicating if an edge is “is.child”. It’s initially set to None and is populated by the <code class="docutils literal notranslate"><span class="pre">initialize</span></code> method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code>: A boolean flag indicating the verbosity of the execution. If it’s set to True, the class will print more information during execution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_jobs</span></code>: The number of parallel jobs to run during computation. By default, it’s set to 1, indicating no parallelization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">random_state</span></code>: The seed for the random number generator. By default, it’s set to 42.</p></li>
</ul>
</section>
<section id="class-structure">
<h2>Class Structure<a class="headerlink" href="#class-structure" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__init__(self,</span> <span class="pre">simulatedDAGs:</span> <span class="pre">SimulatedDAGs,</span> <span class="pre">rev:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">verbose=False,</span> <span class="pre">random_state:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">42,</span> <span class="pre">n_jobs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1)</span> <span class="pre">-&gt;</span> <span class="pre">None</span></code>:
The initializer method for the class. It accepts an instance of the SimulatedDAGs class, flags for considering reverse edges, verbosity, a seed for the random state, and the number of jobs for parallel processing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">initialize(self)</span> <span class="pre">-&gt;</span> <span class="pre">None</span></code>:
This method initializes the D2C object by computing descriptors in parallel for all observations.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_compute_descriptors_for_edge_pairs(self,</span> <span class="pre">DAG_index:</span> <span class="pre">Any)</span> <span class="pre">-&gt;</span> <span class="pre">Tuple[list,</span> <span class="pre">list]</span></code>:
A helper method that computes descriptors in parallel for a given observation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_generate_edge_pairs(self,</span> <span class="pre">DAG_index,</span> <span class="pre">dependency_type:</span> <span class="pre">str)</span> <span class="pre">-&gt;</span> <span class="pre">list</span></code>:
This helper method generates pairs of edges in a DAG according to a specified dependency type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_compute_descriptors(self,</span> <span class="pre">DAG_index,</span> <span class="pre">ca,</span> <span class="pre">ef,</span> <span class="pre">ns=None,</span> <span class="pre">maxs=20,</span> <span class="pre">lin=False,</span> <span class="pre">acc=True,</span> <span class="pre">struct=True,</span> <span class="pre">pq=</span> <span class="pre">[0.05,0.1,0.25,0.5,0.75,0.9,0.95],</span> <span class="pre">boot=&quot;mrmr&quot;)</span></code>:
This is a comprehensive function for computing the descriptor of two variables in a dataset under the assumption that one variable is the cause and the other the effect. It includes numerous optional parameters for customization of the descriptor computation process.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_df(self)</span> <span class="pre">-&gt;</span> <span class="pre">pd.DataFrame</span></code>:
A method to get the concatenated DataFrame of X (descriptors) and Y (labels indicating if an edge is “is.child”).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_score(self,</span> <span class="pre">model:</span> <span class="pre">RandomForestClassifier</span> <span class="pre">=</span> <span class="pre">RandomForestClassifier(),</span> <span class="pre">test_size:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.2,</span> <span class="pre">metric:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&quot;accuracy&quot;)</span> <span class="pre">-&gt;</span> <span class="pre">Union[float,</span> <span class="pre">None]</span></code>:
This method is used to evaluate the performance of a machine learning model using the specified metric. By default, it uses a RandomForestClassifier model and the ‘accuracy’ metric.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Any</span>

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">skew</span><span class="p">,</span> <span class="n">tstd</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">inv</span><span class="p">,</span> <span class="n">pinv</span>

<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="kn">from</span> <span class="nn">d2c.simulatedDAGs</span> <span class="kn">import</span> <span class="n">SimulatedDAGs</span>
<span class="kn">from</span> <span class="nn">d2c.utils</span> <span class="kn">import</span> <span class="o">*</span>


<span class="k">class</span> <span class="nc">D2C</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simulatedDAGs</span><span class="p">:</span> <span class="n">SimulatedDAGs</span><span class="p">,</span> <span class="n">rev</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class for D2C analysis.</span>

<span class="sd">        D2C (Dependency to Causalilty) analysis is a method for inferring causal relationships</span>
<span class="sd">        from observational data using simulated directed acyclic graphs (DAGs) and computing </span>
<span class="sd">        asymmetric descriptors from the observations associated with each DAG.</span>

<span class="sd">        Args:</span>
<span class="sd">            simulatedDAGs (SimulatedDAGs): An instance of the SimulatedDAGs class.</span>
<span class="sd">            rev (bool, optional): Whether to consider reverse edges. Defaults to True.</span>
<span class="sd">            n_jobs (int, optional): Number of parallel jobs. Defaults to 1.</span>
<span class="sd">            random_state (int, optional): Random seed. Defaults to 42.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DAGs_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">simulatedDAGs</span><span class="o">.</span><span class="n">list_DAGs</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DAGs</span> <span class="o">=</span> <span class="n">simulatedDAGs</span><span class="o">.</span><span class="n">list_DAGs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observations_from_DAGs</span> <span class="o">=</span> <span class="n">simulatedDAGs</span><span class="o">.</span><span class="n">list_observations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rev</span> <span class="o">=</span> <span class="n">rev</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>

    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the D2C object by computing descriptors in parallel for all observations.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_compute_descriptors_for_edge_pairs</span><span class="p">(</span><span class="n">DAG_index</span><span class="p">)</span> <span class="k">for</span> <span class="n">DAG_index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DAGs_index</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
                <span class="n">results</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">starmap</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_compute_descriptors_for_edge_pairs</span><span class="p">,</span>
                    <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DAGs_index</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="n">X_list</span><span class="p">,</span> <span class="n">Y_list</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">results</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="k">for</span> <span class="n">X</span> <span class="ow">in</span> <span class="n">X_list</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="k">for</span> <span class="n">Y</span> <span class="ow">in</span> <span class="n">Y_list</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_compute_descriptors_for_edge_pairs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DAG_index</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute descriptors in parallel for a given observation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">edge_pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_edge_pairs</span><span class="p">(</span><span class="n">DAG_index</span><span class="p">,</span><span class="s2">&quot;is.child&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">edge_pair</span> <span class="ow">in</span> <span class="n">edge_pairs</span><span class="p">:</span>
            <span class="n">parent</span><span class="p">,</span> <span class="n">child</span> <span class="o">=</span> <span class="n">edge_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edge_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">descriptor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_descriptors</span><span class="p">(</span><span class="n">DAG_index</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">child</span><span class="p">)</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">descriptor</span><span class="p">)</span>
            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Label edge as &quot;is.child&quot;</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rev</span><span class="p">:</span>
                <span class="c1"># Reverse edge direction</span>
                <span class="n">descriptor_reverse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_descriptors</span><span class="p">(</span><span class="n">DAG_index</span><span class="p">,</span> <span class="n">child</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
                <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">descriptor_reverse</span><span class="p">)</span>
                <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Label reverse edge as NOT &quot;is.child&quot;</span>

        <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span>
    
    <span class="k">def</span> <span class="nf">load_descriptors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;dataframe.csv&#39;</span><span class="p">):</span>
        <span class="n">descriptors</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">descriptors</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">descriptors</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1">#TODO: handle multivariate case</span>


    <span class="k">def</span> <span class="nf">_generate_edge_pairs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DAG_index</span><span class="p">,</span> <span class="n">dependency_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate pairs of edges based on the dependency type.</span>

<span class="sd">        Args:</span>
<span class="sd">            dependency_type (str): The type of dependency.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: List of edge pairs.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">edge_pairs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">dependency_type</span> <span class="o">==</span> <span class="s2">&quot;is.child&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">parent_node</span><span class="p">,</span> <span class="n">child_node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DAGs</span><span class="p">[</span><span class="n">DAG_index</span><span class="p">]</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
                <span class="n">edge_pairs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">parent_node</span><span class="p">,</span> <span class="n">child_node</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Edge pairs for DAG&quot;</span><span class="p">,</span> <span class="n">DAG_index</span><span class="p">,</span> <span class="s2">&quot;computed:&quot;</span><span class="p">,</span> <span class="n">edge_pairs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">edge_pairs</span>

    


    <span class="k">def</span> <span class="nf">_compute_descriptors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DAG_index</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">ef</span><span class="p">,</span> <span class="n">ns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
            <span class="n">lin</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">struct</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">pq</span><span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.95</span><span class="p">],</span> <span class="n">boot</span><span class="o">=</span><span class="s2">&quot;mrmr&quot;</span><span class="p">):</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute descriptor of two variables in a dataset under the assumption that one variable is the cause and the other the effect.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        ca (int): Node index of the putative cause. Must be in the range [0, n).</span>
<span class="sd">        ef (int): Node index of the putative effect. Must be in the range [0, n).</span>
<span class="sd">        ns (int, optional): Size of the Markov Blanket. Defaults to min(4, n - 2).</span>
<span class="sd">        lin (bool, optional): If True, uses a linear model to assess dependency. Defaults to False.</span>
<span class="sd">        acc (bool, optional): If True, uses the accuracy of the regression as a descriptor. Defaults to True.</span>
<span class="sd">        struct (bool, optional): If True, uses the ranking in the Markov blanket as a descriptor. Defaults to False.</span>
<span class="sd">        pq (list of float, optional): A list of quantiles used to compute the descriptor. Defaults to [0.1,0.25,0.5,0.75,0.9].</span>
<span class="sd">        maxs (int, optional): Max number of pairs MB(i), MB(j) considered. Defaults to 10.</span>
<span class="sd">        boot (str, optional): Feature selection algorithm. Defaults to &quot;mimr&quot;.</span>
<span class="sd">        errd (bool, optional): If True, includes the descriptors of the error. Defaults to False.</span>
<span class="sd">        delta (bool, optional): Not used in current implementation. Defaults to False.</span>
<span class="sd">        stabD (bool, optional): Not used in current implementation. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">        dict: A dictionary with the computed descriptors.</span>

<span class="sd">        Raises:</span>
<span class="sd">        ValueError: If there are missing or infinite values in D.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">D</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">observations_from_DAGs</span><span class="p">[</span><span class="n">DAG_index</span><span class="p">]</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Computing descriptors for edge pair: &#39;</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">ef</span><span class="p">,</span> <span class="s1">&#39;in DAG&#39;</span><span class="p">,</span> <span class="n">DAG_index</span><span class="p">)</span>

        <span class="c1">#scale using pandas</span>
        <span class="n">D</span> <span class="o">=</span> <span class="p">(</span><span class="n">D</span> <span class="o">-</span> <span class="n">D</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">D</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">D</span><span class="p">))</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">D</span><span class="p">)):</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error: NA or Inf in descriptor&quot;</span><span class="p">)</span> <span class="c1"># Check if there are any missing or infinite values in the data</span>
    
        <span class="c1"># Number of variables</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># Number of observations</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


        <span class="c1"># Set default value for ns if not provided</span>
        <span class="k">if</span> <span class="n">ns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ns</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Check that ca and ef are within the valid range</span>
        <span class="k">if</span> <span class="n">ca</span> <span class="o">&gt;=</span> <span class="n">n</span> <span class="ow">or</span> <span class="n">ef</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ca=</span><span class="si">{</span><span class="n">ca</span><span class="si">}</span><span class="s2">, ef=</span><span class="si">{</span><span class="n">ef</span><span class="si">}</span><span class="s2">, n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="se">\n</span><span class="s2">error in D2C_n&quot;</span><span class="p">)</span>
    

        <span class="c1"># Initial sets for Markov Blanket</span>
        <span class="n">MBca</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">-</span> <span class="p">{</span><span class="n">ca</span><span class="p">}</span>
        <span class="n">MBef</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">-</span> <span class="p">{</span><span class="n">ef</span><span class="p">}</span>
        <span class="c1"># intersection of the Markov Blanket of ca and ef</span>
        <span class="n">common_causes</span> <span class="o">=</span> <span class="n">MBca</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">MBef</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;common_causes: &quot;</span><span class="p">,</span> <span class="n">common_causes</span><span class="p">)</span>
        <span class="c1"># Creation of the Markov Blanket of ca (denoted MBca) and ef (MBef)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">ns</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Computing Markov Blanket&quot;</span><span class="p">)</span>
            <span class="c1"># MBca</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">-</span> <span class="p">{</span><span class="n">ca</span><span class="p">})</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> 
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;About to rankrho&quot;</span><span class="p">)</span>

            <span class="n">ind</span> <span class="o">=</span> <span class="n">rankrho</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">ind</span><span class="p">],</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">ca</span><span class="p">],</span><span class="n">nmax</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">),</span><span class="mi">5</span><span class="o">*</span><span class="n">ns</span><span class="p">),</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1">#python starts from 0</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ind:&#39;</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exited rankrho&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">boot</span> <span class="o">==</span> <span class="s2">&quot;mrmr&quot;</span><span class="p">:</span>
                <span class="n">mrmr</span> <span class="o">=</span> <span class="n">mRMR</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">ind</span><span class="p">],</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">ca</span><span class="p">],</span><span class="n">nmax</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
                <span class="n">MBca</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="n">mrmr</span><span class="p">]</span>  
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MBca: &quot;</span><span class="p">,</span> <span class="n">MBca</span><span class="p">)</span>
            <span class="c1"># MBef</span>
            <span class="n">ind2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">-</span> <span class="p">{</span><span class="n">ef</span><span class="p">})</span>
            <span class="n">ind2</span> <span class="o">=</span> <span class="n">rankrho</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">ind2</span><span class="p">],</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">ef</span><span class="p">],</span><span class="n">nmax</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind2</span><span class="p">),</span><span class="mi">5</span><span class="o">*</span><span class="n">ns</span><span class="p">),</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>  
            <span class="k">if</span> <span class="n">boot</span> <span class="o">==</span> <span class="s2">&quot;mrmr&quot;</span><span class="p">:</span>
                <span class="n">MBef</span> <span class="o">=</span> <span class="n">ind2</span><span class="p">[</span><span class="n">mRMR</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">ind2</span><span class="p">],</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">ef</span><span class="p">],</span><span class="n">nmax</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)]</span>  
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MBef: &quot;</span><span class="p">,</span> <span class="n">MBef</span><span class="p">)</span>
    
        <span class="k">if</span> <span class="n">acc</span><span class="p">:</span>
            <span class="n">comcau</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">common_causes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;common_causes: &quot;</span><span class="p">,</span> <span class="n">common_causes</span><span class="p">)</span>
                <span class="n">comcau</span> <span class="o">=</span> <span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="nb">list</span><span class="p">(</span><span class="n">common_causes</span><span class="p">)],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> 

            <span class="n">effca</span> <span class="o">=</span> <span class="n">coeff</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBef</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
            <span class="n">effef</span> <span class="o">=</span> <span class="n">coeff</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBca</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;effca: &quot;</span><span class="p">,</span> <span class="n">effca</span><span class="p">,</span> <span class="s2">&quot;effef: &quot;</span><span class="p">,</span> <span class="n">effef</span><span class="p">)</span>

            <span class="n">ca_ef</span> <span class="o">=</span> <span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> 
            <span class="n">ef_ca</span> <span class="o">=</span> <span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> 

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ca_ef: &quot;</span><span class="p">,</span> <span class="n">ca_ef</span><span class="p">,</span> <span class="s2">&quot;ef_ca: &quot;</span><span class="p">,</span> <span class="n">ef_ca</span><span class="p">)</span>

            <span class="n">delta</span> <span class="o">=</span> <span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBef</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> 
            <span class="n">delta2</span> <span class="o">=</span> <span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBca</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> 

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;delta: &quot;</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="s2">&quot;delta2: &quot;</span><span class="p">,</span> <span class="n">delta2</span><span class="p">)</span>    


            <span class="n">delta_i</span> <span class="o">=</span> <span class="p">[]</span>  
            <span class="n">delta2_i</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">arrays_m_plus_MBca</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">array</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="n">m</span><span class="p">],</span> <span class="n">MBca</span><span class="p">))</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">MBef</span><span class="p">]]</span>
            <span class="n">arrays_m_plus_MBef</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">array</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="n">m</span><span class="p">],</span> <span class="n">MBef</span><span class="p">))</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">MBca</span><span class="p">]]</span>

            <span class="k">for</span> <span class="n">array</span> <span class="ow">in</span> <span class="n">arrays_m_plus_MBca</span><span class="p">:</span>
                <span class="n">delta_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span>  <span class="n">array</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">array</span> <span class="ow">in</span> <span class="n">arrays_m_plus_MBef</span><span class="p">:</span>
                <span class="n">delta2_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span>  <span class="n">array</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">))</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;delta_i: &quot;</span><span class="p">,</span> <span class="n">delta_i</span><span class="p">,</span> <span class="s2">&quot;delta2_i: &quot;</span><span class="p">,</span> <span class="n">delta2_i</span><span class="p">)</span>

            <span class="n">I1_i</span> <span class="o">=</span> <span class="p">[</span><span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBef</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MBef</span><span class="p">))]</span>
            <span class="n">I1_j</span> <span class="o">=</span> <span class="p">[</span><span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBca</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MBca</span><span class="p">))]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I1_i: &quot;</span><span class="p">,</span> <span class="n">I1_i</span><span class="p">,</span> <span class="s2">&quot;I1_j: &quot;</span><span class="p">,</span> <span class="n">I1_j</span><span class="p">)</span>

            <span class="n">I2_i</span> <span class="o">=</span> <span class="p">[</span><span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBef</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MBef</span><span class="p">))]</span>
            <span class="n">I2_j</span> <span class="o">=</span> <span class="p">[</span><span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBca</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MBca</span><span class="p">))]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I2_i: &quot;</span><span class="p">,</span> <span class="n">I2_i</span><span class="p">,</span> <span class="s2">&quot;I2_j: &quot;</span><span class="p">,</span> <span class="n">I2_j</span><span class="p">)</span>

            <span class="c1"># Randomly select maxs pairs</span>
            <span class="n">IJ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MBca</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MBef</span><span class="p">))))</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
            <span class="n">IJ</span> <span class="o">=</span> <span class="n">IJ</span><span class="p">[:</span><span class="nb">min</span><span class="p">(</span><span class="n">maxs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">IJ</span><span class="p">))]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;IJ: &quot;</span><span class="p">,</span> <span class="n">IJ</span><span class="p">)</span>

            <span class="n">I3_i</span> <span class="o">=</span> <span class="p">[</span><span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBca</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBef</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">IJ</span><span class="p">]</span>
            <span class="n">I3_j</span> <span class="o">=</span> <span class="p">[</span><span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBca</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBef</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">IJ</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I3_i: &quot;</span><span class="p">,</span> <span class="n">I3_i</span><span class="p">,</span> <span class="s2">&quot;I3_j: &quot;</span><span class="p">,</span> <span class="n">I3_j</span><span class="p">)</span>

            <span class="n">IJ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MBca</span><span class="p">))</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">MBca</span><span class="p">))])</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
            <span class="n">IJ</span> <span class="o">=</span> <span class="n">IJ</span><span class="p">[:</span><span class="nb">min</span><span class="p">(</span><span class="n">maxs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">IJ</span><span class="p">))]</span>

            <span class="n">Int3_i</span> <span class="o">=</span> <span class="p">[</span><span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBca</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBca</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> <span class="o">-</span> <span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBca</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBca</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">IJ</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Int3_i: &quot;</span><span class="p">,</span> <span class="n">Int3_i</span><span class="p">)</span>

            <span class="n">IJ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MBef</span><span class="p">))</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">MBef</span><span class="p">))])</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
            <span class="n">IJ</span> <span class="o">=</span> <span class="n">IJ</span><span class="p">[:</span><span class="nb">min</span><span class="p">(</span><span class="n">maxs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">IJ</span><span class="p">))]</span>

            <span class="n">Int3_j</span> <span class="o">=</span> <span class="p">[</span><span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBef</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBef</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> <span class="o">-</span> <span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBef</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBef</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">IJ</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Int3_j: &quot;</span><span class="p">,</span> <span class="n">Int3_j</span><span class="p">)</span>

            <span class="n">E_ef</span> <span class="o">=</span> <span class="n">ecdf</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">])</span> 
            <span class="n">E_ca</span> <span class="o">=</span> <span class="n">ecdf</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">])</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;E_ef: &quot;</span><span class="p">,</span> <span class="n">E_ef</span><span class="p">,</span> <span class="s2">&quot;E_ca: &quot;</span><span class="p">,</span> <span class="n">E_ca</span><span class="p">)</span>

            <span class="n">gini_ca_ef</span> <span class="o">=</span> <span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">E_ef</span><span class="p">),</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
            <span class="n">gini_ef_ca</span> <span class="o">=</span> <span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">E_ca</span><span class="p">),</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;gini_ca_ef: &quot;</span><span class="p">,</span> <span class="n">gini_ca_ef</span><span class="p">,</span> <span class="s2">&quot;gini_ef_ca: &quot;</span><span class="p">,</span> <span class="n">gini_ef_ca</span><span class="p">)</span>

            <span class="n">gini_delta</span> <span class="o">=</span> <span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ef</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">E_ca</span><span class="p">),</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBef</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
            <span class="n">gini_delta2</span> <span class="o">=</span> <span class="n">normalized_conditional_information</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">ca</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">E_ef</span><span class="p">),</span> <span class="n">D</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">MBca</span><span class="p">],</span> <span class="n">lin</span><span class="o">=</span><span class="n">lin</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;gini_delta: &quot;</span><span class="p">,</span> <span class="n">gini_delta</span><span class="p">,</span> <span class="s2">&quot;gini_delta2: &quot;</span><span class="p">,</span> <span class="n">gini_delta2</span><span class="p">)</span>

            <span class="n">namesx</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;effca&quot;</span><span class="p">,</span><span class="s2">&quot;effef&quot;</span><span class="p">,</span><span class="s2">&quot;comcau&quot;</span><span class="p">,</span><span class="s2">&quot;delta&quot;</span><span class="p">,</span><span class="s2">&quot;delta2&quot;</span><span class="p">]</span>
            <span class="n">namesx</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;delta.i&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pq</span><span class="p">))]</span>
            <span class="n">namesx</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;delta2.i&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pq</span><span class="p">))]</span>
            <span class="n">namesx</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;ca.ef&quot;</span><span class="p">,</span><span class="s2">&quot;ef.ca&quot;</span><span class="p">]</span>
            <span class="n">namesx</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;I1.i&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pq</span><span class="p">))]</span>
            <span class="n">namesx</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;I1.j&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pq</span><span class="p">))]</span>
            <span class="n">namesx</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;I2.i&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pq</span><span class="p">))]</span>
            <span class="n">namesx</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;I2.j&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pq</span><span class="p">))]</span>
            <span class="n">namesx</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;I3.i&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pq</span><span class="p">))]</span>
            <span class="n">namesx</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;I3.j&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pq</span><span class="p">))]</span>
            <span class="n">namesx</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;Int3.i&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pq</span><span class="p">))]</span>
            <span class="n">namesx</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;Int3.j&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pq</span><span class="p">))]</span>
            <span class="n">namesx</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;gini.delta&quot;</span><span class="p">,</span><span class="s2">&quot;gini.delta2&quot;</span><span class="p">,</span><span class="s2">&quot;gini.ca.ef&quot;</span><span class="p">,</span><span class="s2">&quot;gini.ef.ca&quot;</span><span class="p">]</span>

            <span class="n">keys</span> <span class="o">=</span> <span class="n">namesx</span>
            
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">effca</span><span class="p">,</span> <span class="n">effef</span><span class="p">,</span> <span class="n">comcau</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">delta2</span><span class="p">]</span>
            <span class="n">values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">delta_i</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">pq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span> 
            <span class="n">values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">delta2_i</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">pq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span> 
            <span class="n">values</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">ca_ef</span><span class="p">,</span> <span class="n">ef_ca</span><span class="p">])</span>
            <span class="n">values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">I1_i</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">pq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span> 
            <span class="n">values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">I1_j</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">pq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span> 
            <span class="n">values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">I2_i</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">pq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span> 
            <span class="n">values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">I2_j</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">pq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span> 
            <span class="n">values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">I3_i</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">pq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span> 
            <span class="n">values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">I3_j</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">pq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span> 
            <span class="n">values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">Int3_i</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">pq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span> 
            <span class="n">values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">Int3_j</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">pq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span> 
            <span class="n">values</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">gini_delta</span><span class="p">,</span> <span class="n">gini_delta2</span><span class="p">,</span><span class="n">gini_ca_ef</span><span class="p">,</span> <span class="n">gini_ef_ca</span><span class="p">])</span> 

            
            <span class="c1"># Replace NA values with 0</span>
            <span class="n">dictionary</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>
            <span class="c1"># for key in dictionary:</span>
            <span class="c1">#     if np.isnan(dictionary[key]):</span>
            <span class="c1">#         dictionary[key] = 0</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Descriptors for DAG&quot;</span><span class="p">,</span> <span class="n">DAG_index</span><span class="p">,</span> <span class="s2">&quot;edge pair&quot;</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">ef</span><span class="p">,</span> <span class="s2">&quot;computed&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">dictionary</span>


    <span class="k">def</span> <span class="nf">get_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the concatenated DataFrame of X and Y.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: The concatenated DataFrame of X and Y.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    

    <span class="k">def</span> <span class="nf">get_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">RandomForestClassifier</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(),</span> <span class="n">test_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;accuracy&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the score of a machine learning model using the specified metric.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            model (RandomForestClassifier): The machine learning model to evaluate.</span>
<span class="sd">            test_size (float): The proportion of the data to use for testing.</span>
<span class="sd">            metric (str): The evaluation metric to use (default is &quot;accuracy&quot;). Valid metrics are: &#39;accuracy&#39;, &#39;f1&#39;, &#39;precision&#39;, &#39;recall&#39;, &#39;auc&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: The score of the model using the specified metric.</span>
<span class="sd">        </span>
<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If an invalid metric is provided.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y</span>

        <span class="c1"># Split the data into training and testing sets</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">test_size</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>

        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="c1"># Create an instance of the Random Forest classifier</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>

        <span class="c1"># Train the model</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># Get the accuracy of the model</span>
        <span class="k">if</span> <span class="n">metric</span> <span class="o">==</span> <span class="s2">&quot;accuracy&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">metric</span> <span class="o">==</span> <span class="s2">&quot;f1&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">metric</span> <span class="o">==</span> <span class="s2">&quot;precision&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">metric</span> <span class="o">==</span> <span class="s2">&quot;recall&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">metric</span> <span class="o">==</span> <span class="s2">&quot;auc&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid metric. Valid metrics are: &#39;accuracy&#39;, &#39;f1&#39;, &#39;precision&#39;, &#39;recall&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="D2C_examples.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Examples</p>
      </div>
    </a>
    <a class="right-next"
       href="utils.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Utilities Functions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#class-attributes">Class Attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#class-structure">Class Structure</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gian Marco Paldino
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>